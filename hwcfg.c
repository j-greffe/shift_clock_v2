#include "hwcfg.h"

const uint16_t k_brightness_lut[100] = {
    0x0018, 0x0018, 0x0018, 0x0018, 0x0018, 0x0018, 0x0018, 0x0018, 0x0018, 0x0018,
    0x0022, 0x0022, 0x0022, 0x0022, 0x0022, 0x0022, 0x0022, 0x0022, 0x0022, 0x0022,
    0x002C, 0x002C, 0x002C, 0x002C, 0x002C, 0x002C, 0x002C, 0x002C, 0x002C, 0x002C,
    0x0036, 0x0036, 0x0036, 0x0036, 0x0036, 0x0036, 0x0036, 0x0036, 0x0036, 0x0036,
    0x0040, 0x0040, 0x0040, 0x0040, 0x0040, 0x0040, 0x0040, 0x0040, 0x0040, 0x0040,
    0x0058, 0x0058, 0x0058, 0x0058, 0x0058, 0x0058, 0x0058, 0x0058, 0x0058, 0x0058,
    0x0095, 0x0095, 0x0095, 0x0095, 0x0095, 0x0095, 0x0095, 0x0095, 0x0095, 0x0095,
    0x00F0, 0x00F0, 0x00F0, 0x00F0, 0x00F0, 0x00F0, 0x00F0, 0x00F0, 0x00F0, 0x00F0,
    0x016F, 0x016F, 0x016F, 0x016F, 0x016F, 0x016F, 0x016F, 0x016F, 0x016F, 0x016F,
    0x02F1, 0x02F1, 0x02F1, 0x02F1, 0x02F1, 0x02F1, 0x02F1, 0x02F1, 0x02F1, 0x02F1,
};

const shift_register_74hc595x_hwcfg_t k_shift_register_hwcfg = {
    .io_ena = HAL_IO_NONE,
    .io_sck = IO_SCK,
    .io_ser = IO_SER,
    .io_rck = IO_RCK,
    .io_clr = IO_CLR
};

const shift_digit_hwcfg_t k_shift_digit_hwcfg = {
    // Match segments to shift register output bits
    .seg_a = (1 << 0),
    .seg_b = (1 << 1),
    .seg_c = (1 << 2),
    .seg_d = (1 << 3),
    .seg_e = (1 << 4),
    .seg_f = (1 << 4),
    .seg_g = (1 << 6),
    .seg_h = (1 << 7),
    // Shift register hardware config
    .shift_register_hwcfg = (void*)&k_shift_register_hwcfg,
    // PWM pin for brightness control
    .io_pwm = IO_ENA,
    // int16_t[100] look up table to convert percent into PWM duty cycle (1-1023)
    .brightness_lut = k_brightness_lut,
};
