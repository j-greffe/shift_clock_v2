#include "hwcfg.h"

const uint16_t k_brightness_lut[100] = {
    0x0001,0x0019,0x001A,0x001B,0x001C,0x001D,0x001E,0x001F,0x0020,0x0021,
    0x002C,0x002D,0x002E,0x002F,0x0030,0x0031,0x0032,0x0033,0x0034,0x0035,
    0x0036,0x0037,0x0038,0x0039,0x003A,0x003B,0x003C,0x003D,0x003E,0x003F,
    0x0040,0x0041,0x0042,0x0043,0x0044,0x0045,0x0046,0x004A,0x004E,0x0053,
    0x0058,0x005C,0x0062,0x0067,0x006D,0x0073,0x0079,0x007F,0x0086,0x008D,
    0x0095,0x009C,0x00A4,0x00AC,0x00B5,0x00BE,0x00C7,0x00D1,0x00DB,0x00E5,
    0x00F0,0x00FA,0x0106,0x0112,0x011E,0x012A,0x0137,0x0144,0x0152,0x0160,
    0x016F,0x017D,0x018D,0x019D,0x01AD,0x01BD,0x01CE,0x01E0,0x01F2,0x0205,
    0x0218,0x022B,0x023F,0x0253,0x0268,0x027E,0x0294,0x02AA,0x02C1,0x02D8,
    0x02F1,0x0309,0x0322,0x033C,0x0356,0x0371,0x038C,0x03A8,0x03C5,0x0400
};

const shift_register_74hc595x_hwcfg_t k_shift_register_hwcfg = {
    .io_ena = HAL_IO_NONE,
    .io_sck = IO_SCK,
    .io_ser = IO_SER,
    .io_rck = IO_RCK,
    .io_clr = IO_CLR
};

const shift_digit_hwcfg_t k_shift_digit_hwcfg = {
    // Match segments to shift register output bits
    .seg_a = (1 << 0),
    .seg_b = (1 << 1),
    .seg_c = (1 << 2),
    .seg_d = (1 << 3),
    .seg_e = (1 << 4),
    .seg_f = (1 << 5),
    .seg_g = (1 << 6),
    .seg_h = (1 << 7),
    // Shift register hardware config
    .shift_register_hwcfg = (void*)&k_shift_register_hwcfg,
    // PWM pin for brightness control
    .io_pwm = IO_ENA,
    // int16_t[100] look up table to convert percent into PWM duty cycle (1-1023)
    .brightness_lut = k_brightness_lut,
};
